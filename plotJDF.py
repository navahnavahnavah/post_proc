import numpy as np
import matplotlib.pyplot as plt
import matplotlib.cm as cm
import math
import streamplot as sp
plt.rcParams['contour.negative_linestyle'] = 'solid'
plt.rc('font', family='Arial')

plt.rc('xtick', labelsize=8)
plt.rc('ytick', labelsize=8)
plt.rcParams['xtick.major.size'] = 0
plt.rcParams['ytick.major.size'] = 0
plt.rcParams['xtick.major.pad'] = 3
plt.rcParams['ytick.major.pad'] = 3
plt.rcParams['axes.linewidth'] = 1.0
plt.rcParams['axes.color_cycle'] = "#CE1836, #F85931, #EDB92E, #A3A948, #009989"

print "doing something..."

sec = ['zero', 'stilbite', 'sio2', 'kaolinite', 'albite', 'saponite', 'celadonite',
       'clinoptilolite', 'pyrite', 'mont_na', 'goethite', 'dolomite', 'smectite',
       'dawsonite', 'magnesite', 'siderite', 'calcite', 'quartz', 'kspar', 'saponite_na',
       'nont_na', 'nont_mg', 'nont_k', 'nont_h', 'nont_ca', 'muscovite', 'mesolite',
       'hematite', 'diaspore', 'akermanite', 'analcime', 'annite', 'clinozoisite',
        'dicalcium_silicate', 'diopside', 'epidote', 'ettringite', 'ferrite_ca', 'foshagite',
        'gismondine', 'gyrolite', 'hedenbergite', 'hillebrandite', 'larnite', 'laumontite',
        'lawsonite', 'merwinite', 'monticellite', 'natrolite', 'okenite', 'phlogopite',
        'prehnite', 'pseudowollastonite', 'rankinite', 'scolecite', 'tobermorite_9a',
        'tremolite', 'wollastonite', 'xonotlite', 'zoisite', 'andradite', 'troilite',
        'pyrrhotite', 'minnesotaite', 'fayalite', 'daphnite_7a', 'daphnite_14a',
        'cronstedtite_7a', 'greenalite', 'aragonite']

##############
# INITIALIZE #
##############

cell = 5
#steps = 400
steps = 20

path = "output/revival/coarse_grid/coarsify_test/"
#path = ""


# load output
x0 = np.loadtxt(path + 'x.txt',delimiter='\n')
y0 = np.loadtxt(path + 'y.txt',delimiter='\n')

# format plotting geometry
x=x0
y=y0
bits = len(x)

xCell = x0
yCell = y0
xCell = xCell[::cell]
yCell= yCell[::cell]
xCell = np.append(xCell, np.max(xCell)+xCell[1])
yCell = np.append(yCell, np.max(yCell)-yCell[-1])
bitsC = len(xCell)
print bitsC

print xCell
print yCell

xg, yg = np.meshgrid(x[:],y[:])


xb = 34*bits/50 - bits/5
xa = 34*bits/50

xcb = 34*bitsC/50 - bitsC/5
xca = 34*bitsC/50



psi0 = np.loadtxt(path + 'psiMat.txt')
perm0 = np.loadtxt(path + 'permMat.txt')
perm0 = np.log10(perm0)
temp0 = np.loadtxt(path + 'hMat.txt')


#temp0[temp0<273.0] = 273.0
temp0 = temp0 - 273.0

ca_e0 = np.loadtxt(path + 'sol_ca.txt')
mg_e0 = np.loadtxt(path + 'sol_mg.txt')
mesh = np.loadtxt(path + 'mesh.txt')
lam = np.loadtxt(path + 'lambdaMat.txt')

# IMPORT MINERALS

pyrite0 = np.loadtxt(path + 'sec8.txt')
goethite0 = np.loadtxt(path + 'sec10.txt')
calcite0 = np.loadtxt(path + 'sec16.txt')
pyrr0 = np.loadtxt(path + 'sec62.txt')
saponite0 = np.loadtxt(path + 'sec5.txt') + np.loadtxt(path + 'sec60.txt')
celadonite0 = np.loadtxt(path + 'sec6.txt')
nontronite0 = np.loadtxt(path + 'sec20.txt') + np.loadtxt(path + 'sec21.txt') + np.loadtxt(path + 'sec24.txt')
zeolites0 = np.loadtxt(path + 'sec26.txt') + np.loadtxt(path + 'sec39.txt')# + np.loadtxt(path + 'sec1.txt')
hematite0 = np.loadtxt(path + 'sec27.txt')
talc0 = np.loadtxt(path+'sec49.txt')

#limit = np.where(geo0 >= .0006)
#geo0[limit] = 0.0

def plotMin(step,matrix,nlabel,colormap,outline):
    p5_range = np.linspace(np.min(matrix[np.nonzero(matrix)]),
                           np.max(matrix[np.nonzero(matrix)]/1.0),levs)
    p5 = plt.contourf(xCell,yCell,step, p5_range,cmap=colormap,alpha=alph,antialiased=True)
    p5l = plt.contour(xCell,yCell,step, p5_range,colors=outline,linewidths=2.0)
    p5l.collections[0].set_label(nlabel)
    return

def cut(geo0,index):
    geo_cut = geo0[(index*len(y0)/cell):(index*len(y0)/cell+len(y0)/cell),:]
    geo_cut = np.append(geo_cut, geo_cut[-1:,:], axis=0)
    geo_cut = np.append(geo_cut, geo_cut[:,-1:], axis=1)
    return geo_cut

 
for i in range(0,steps,1): 

    #######################
    # FORMAT GRIDDED DATA #
    #######################
    
    ##    h = h0[i*len(y)-i:((i)*len(y)+len(x))-i-1,:]
    ##    h = np.append(h, h[-1:,:], axis=0)
    ##    h = np.append(h, h[:,-1:], axis=1)

    psi = psi0[i*len(y):((i)*len(y)+len(x)),:]
    perm = perm0[i*len(y):((i)*len(y)+len(x)),:]
    temp = temp0[i*len(y):((i)*len(y)+len(x)),:]


    ca_e = cut(ca_e0,i)
    mg_e = cut(mg_e0,i)
    
    pyrite = cut(pyrite0,i)
    goethite = cut(goethite0,i)
    print goethite
    calcite = cut(calcite0,i)
    pyrr = cut(pyrr0,i)
    saponite = cut(saponite0,i)
    celadonite = cut(celadonite0,i)
    nontronite = cut(nontronite0,i)
    zeolites = cut(zeolites0,i)
    hematite = cut(hematite0,i)
    talc = cut(talc0,i)
    


    #############
    # HEAT PLOT #
    #############

    fig=plt.figure()
    ax1=fig.add_subplot(1,1,1, aspect=6.0)
    ax1.patch.set_facecolor('white')

    pGlass = plt.contourf(x, y, temp, 20, vmin=np.min(temp0[np.nonzero(temp0)]),
                         vmax=np.max(temp0[np.nonzero(temp0)]),
                         cmap=cm.jet, alpha=0.5,linewidth=0.0, color='#444444',antialiased=True)
    cbar= plt.colorbar(pGlass, orientation='horizontal')
    cbar.ax.set_xlabel('TEMPERATURE [$^{o}$C]')

    p = plt.contour(xg,yg,perm,[-14.15,-18],colors='black',linewidths=np.array([4.0]))
    #psiMask[np.abs(psiMask)>=1.0e-6] = 1.0e-6
    CS = plt.contour(xg, yg, psi, 8, colors='black',linewidths=np.array([1.0]))

##    plt.plot([x[xb], x[xb]], [-1200.0, 0.0],
##             linewidth=3.0, color=scolor)
##    plt.text(x[xb]-85.0, 20.0, '504B',
##        bbox={'facecolor':scolor, 'alpha':1.0, 'pad':10},fontsize=12)
##
##    plt.plot([x[xa], x[xa]], [-1200.0, 0.0],
##             linewidth=3.0, color=scolor)
##    plt.text(x[xa]-85.0, 20.0, '896A',
##        bbox={'facecolor':scolor, 'alpha':1.0, 'pad':10},fontsize=12)

    plt.savefig(path+'jdfTemp_'+str(i)+'.png')





print "ALL DONE!"


#####################
# MINERAL BENCHMARK #
#####################


# horizontal slices
def slice(mineral):
    slice = np.zeros(len(xCell)+1)
    for i in range(len(xCell)+1):
        slice[i] = sum(mineral[:,i-1])
        if slice[i] < 99.0 and slice[i] > 0:
            slice[i] = i
        else:
            slice[i] = None
    return slice
    
    
# mg-saponite 0 Y
# ca-saponite 1 Y
# nontronite 2 Y
# celadonite 3 Y
# goethite 4 Y
# hematite 5
# pyrite 6 Y
# pyrr 7 Y
# calcite 8 
# aragonite 9
# zeolites 10
# smectites 11
# talc 12
# phillipsite 13
        
# pyrite_slice = slice(pyrite)
# talc_slice = slice(talc)
# print talc_slice



site1023 = 4.0
site1024 = 7.5
site1025 = 15.0
site1030 = 22.0
site1028 = 26.0

ht = np.zeros([5,14])
ht[:,0] = np.array([None, site1024, None, site1030, site1028])
ht[:,1] = np.array([None, site1024, None, site1030, site1028])
ht[:,2] = np.array([None, site1024, None, None, None])
ht[:,3] = np.array([site1023, site1024, site1025, site1030, site1028])
ht[:,4] = np.array([None, site1024, site1025, site1030, site1028])
ht[:,5] = np.array([None, site1024, site1025, site1030, site1028])
ht[:,6] = np.array([site1023, site1024, site1025, site1030, site1028])
ht[:,7] = np.array([None, site1024, None, None, None])
ht[:,8] = np.array([None, site1024, None, site1030, None])
ht[:,9] = np.array([None, site1024, None, site1030, None])
ht[:,10] = np.array([None, site1024, site1025, site1030, site1028])
ht[:,11] = np.array([site1023, site1024, site1025, site1030, site1028])
ht[:,12] = np.array([None, None, None, None, site1028])
ht[:,13] = np.array([None, None, None, None, site1028])

goethite_slice = slice(goethite)
print goethite
pyrite_slice = slice(pyrite)
print pyrite_slice
calcite_slice = slice(calcite)
pyrr_slice = slice(pyrr)
saponite_slice = slice(saponite)
celadonite_slice = slice(celadonite)
nontronite_slice = slice(nontronite)
zeolites_slice = slice(zeolites)
hematite_slice = slice(hematite)
talc_slice = slice(talc)

fig=plt.figure()
ax1=fig.add_subplot(1,1,1)

col = 'b'


plt.plot(saponite_slice*26.0/len(xCell),1.0*np.ones(len(xCell)+1),col,linewidth=5.0)
plt.plot(nontronite_slice*26.0/len(xCell),2.0*np.ones(len(xCell)+1),col,linewidth=5.0)
plt.plot(celadonite_slice*26.0/len(xCell),3.0*np.ones(len(xCell)+1),col,linewidth=5.0)
plt.plot(goethite_slice*26.0/len(xCell),4.0*np.ones(len(xCell)+1),col,linewidth=5.0)
plt.plot(hematite_slice*26.0/len(xCell),5.0*np.ones(len(xCell)+1),col,linewidth=5.0)
plt.plot(pyrite_slice*26.0/len(xCell),6.0*np.ones(len(xCell)+1),col,linewidth=5.0)
plt.plot(pyrr_slice*26.0/len(xCell),7.0*np.ones(len(xCell)+1),col,linewidth=5.0)
plt.plot(calcite_slice*26.0/len(xCell),8.0*np.ones(len(xCell)+1),col,linewidth=5.0)
plt.plot(zeolites_slice*26.0/len(xCell),10.0*np.ones(len(xCell)+1),col,linewidth=5.0)
plt.plot(talc_slice*26.0/len(xCell),12.0*np.ones(len(xCell)+1),col,linewidth=5.0)

plt.scatter(saponite_slice*26.0/len(xCell),1.0*np.ones(len(xCell)+1),facecolor=col,edgecolor='none')
plt.scatter(nontronite_slice*26.0/len(xCell),2.0*np.ones(len(xCell)+1),facecolor=col,edgecolor='none')
plt.scatter(celadonite_slice*26.0/len(xCell),3.0*np.ones(len(xCell)+1),facecolor=col,edgecolor='none')
plt.scatter(goethite_slice*26.0/len(xCell),4.0*np.ones(len(xCell)+1),facecolor=col,edgecolor='none')
plt.scatter(hematite_slice*26.0/len(xCell),5.0*np.ones(len(xCell)+1),facecolor=col,edgecolor='none')
plt.scatter(pyrite_slice*26.0/len(xCell),6.0*np.ones(len(xCell)+1),facecolor=col,edgecolor='none')
plt.scatter(pyrr_slice*26.0/len(xCell),7.0*np.ones(len(xCell)+1),facecolor=col,edgecolor='none')
plt.scatter(calcite_slice*26.0/len(xCell),8.0*np.ones(len(xCell)+1),facecolor=col,edgecolor='none')
plt.scatter(zeolites_slice*26.0/len(xCell),10.0*np.ones(len(xCell)+1),facecolor=col,edgecolor='none')
plt.scatter(talc_slice*26.0/len(xCell),12.0*np.ones(len(xCell)+1),facecolor=col,edgecolor='none')

for i in range(13):
    plt.scatter(ht[:,i],i*np.ones(5),50,facecolor='k',marker='s',edgecolor='k')

plt.xlim([-5.0,30.0])
plt.ylim([-1,13])


plt.yticks(range(1,13), ['Mg-, Ca-saponite', 'Nontronite', 'Celadonite', 'Goethite', 'Hematite', 
'Pyrite', 'Pyrrhotite', 'Calcite', 'Aragonite', 'Zeolites', 'Smectites', 'Talc', 'Phillipsite'])
plt.savefig(path+'jdfMins.eps')

#######################
# HEAT FLOW BENCHMARK #
#######################

ripXdata = np.array([-0.037511077, 0.051208064, 0.095567636, 0.36452672, 0.5438328, 0.6345753, 0.77092266, 
0.9061804, 1.1307799, 1.3107085, 1.7150811, 1.6257393, 1.6710328, 1.6260506, 1.9852074, 2.1197648, 2.141789, 
2.6138682, 2.816288, 3.1089056, 3.1534207, 3.3563852, 3.4454155, 3.78356, 4.076722, 4.416501, 4.5739384, 
5.0681977, 5.38961, 5.6442494, 5.9632235, 6.1732955, 6.5315447, 6.8756814, 7.055195, 7.4145336, 8.047397, 
8.318846, 8.618105, 8.904548, 9.219891, 9.50514, 10.088352, 9.787952, 10.389686, 10.691539, 11.005791, 
11.3214445, 11.592479, 12.511837, 12.195043, 11.83503, 12.809539, 13.108642, 13.602564, 13.902289, 14.525451, 
14.222197, 15.1076765, 14.850027, 15.373834, 16.000938, 16.269638, 16.539686, 16.914537, 17.232473, 17.81994, 
18.12086, 20.531166, 20.753016, 19.927252, 18.487926, 17.53884, 18.304886, 18.739506, 18.933805, 19.76071, 
20.34444, 20.162436, 19.533567, 19.323029, 19.125824, 20.92428, 25.770523, 25.485792, 25.334452, 25.96197, 
25.180826, 23.336714, 23.484838, 23.904049, 23.722511, 23.093903, 24.98248, 24.787504, 24.501995, 24.41146, 
24.097052, 22.94168, 22.71625, 22.536633, 22.297455, 22.133453, 21.98424, 21.773596, 21.564095, 21.325436, 
21.173574])
ripXdata = ripXdata*1000.0


ripQdata = np.array([133.80756, 111.48861, 100.32914, 83.54653, 72.35812, 86.276115, 111.33429, 116.880264, 
111.257126, 111.218544, 102.76937, 113.938484, 119.50375, 119.5134, 106.892685, 99.89511, 91.527916, 87.24546,
 87.20206, 91.32055, 82.94853, 92.661224, 75.9172, 89.78214, 103.65673, 146.78996, 146.75621, 136.89401, 
 119.635574, 114.93516, 188.27066, 191.0131, 162.13223, 149.05016, 141.57835, 132.20967, 187.82376, 215.64046, 
 204.42633, 232.2398, 240.53467, 246.97765, 218.97769, 209.75047, 244.92966, 280.17313, 268.95578, 282.82556, 
 303.20905, 387.56577, 353.25464, 350.54434, 348.47708, 334.4755, 318.5738, 315.72205, 466.11288, 405.7823, 
 420.459, 371.26862, 353.5022, 305.9804, 284.55203, 287.28162, 287.20126, 341.9537, 390.14423, 408.66296, 
 609.7746, 554.9064, 535.57104, 537.738, 458.03342, 482.0274, 478.21756, 467.02594, 506.80267, 488.09424, 
 450.96674, 466.89734, 455.79254, 414.95163, 399.6994, 455.3392, 458.18774, 433.13278, 393.04422, 367.19513, 
 370.37805, 337.82556, 326.58572, 297.8206, 318.39697, 305.9129, 305.02554, 293.9368, 283.7354, 292.1653, 
 277.54642, 268.30313, 273.91663, 286.9762, 303.7363, 316.77658, 303.81348, 311.2917, 333.6428, 299.2963])
 
steinX1 = np.array([0.4235389099554690, 0.5297748648330790, 0.6360108197106900, 0.742246774588301, 
0.8484827294659120, 
0.9547186843435230, 1.0609546392211300, 1.167190594098740, 1.273426548976350, 1.3796625038539700, 
1.4858984587315800, 1.5850520166173500, 1.6452523910479900, 1.698370368486800, 1.680664376007200, 
1.8046063233644100, 1.9108422782420200, 2.01707823311963, 2.1233141879972400, 2.229550142874850, 
2.3357860977524600, 2.4420220526300700, 2.548258007507680, 2.6544939623852900, 2.760729917262910, 
2.8669658721405200, 2.9732018270181300, 3.079437781895740, 3.1856737367733500, 3.291909691650960, 
3.3981456465285700, 3.5043816014061800, 3.610617556283790, 3.7168535111614000, 3.823089466039010, 
3.9293254209166200, 4.035561375794240, 4.134714933680010, 4.2480332855494600, 4.363122236666870, 
4.460505195304680, 4.566741150182290, 4.6729771050599, 4.77921305993751, 4.885449014815120, 
4.991684969692730, 5.097920924570340, 5.204156879447950, 5.310392834325560, 5.416628789203180, 
5.522864744080790, 5.629100698958400, 5.735336653836010, 5.841572608713620, 5.940726166599390, 
6.018632533509640, 6.124868488387250, 6.231104443264860, 6.3373403981424700, 6.443576353020080, 
6.54981230789769, 6.656048262775300, 6.762284217652910, 6.8685201725305200, 6.974756127408130, 
7.080992082285740, 7.187228037163360, 7.293463992040960, 7.3996999469185800, 7.505935901796190, 
7.612171856673800, 7.718407811551410, 7.824643766429020, 7.93087972130663, 8.037115676184240, 
8.143351631061850, 8.249587585939460, 8.355823540817070, 8.426647510735480, 8.532883465613090, 
8.639119420490700, 8.745355375368310, 8.851591330245920, 8.966680281363340, 9.064063240001150, 
9.170299194878760, 9.241123164797160, 9.347359119674770, 9.453595074552390, 9.559831029430000, 
9.666066984307610, 9.78115593542502, 9.878538894062830, 9.98477484894044, 10.09101080381800, 
10.206099754935500, 10.303482713573300, 10.409718668450900, 10.515954623328500, 
10.622190578206100, 10.728426533083700, 10.834662487961300, 10.940898442838900, 
11.047134397716500, 11.153370352594200, 11.224194322512600, 11.339283273630000, 
11.429583835275900, 11.507490202186200, 11.578314172104600, 11.649138142023000, 
11.719962111941400, 11.77308008938020, 11.826198066819000, 11.808492074339400, 11.808492074339400, 
11.790786081859800, 11.908826031723800, 11.96784600665580, 12.038669976574200, 12.109493946492700, 
12.215729901370300, 12.304259863768300, 12.36918183619350, 12.428201811125500, 12.499025781043900, 
12.576932147954100, 12.65837971336030, 12.676085705839900, 12.739827278766500, 12.817733645676700, 
12.923969600554300, 13.030205555431900, 13.13644151030960, 13.24267746518720, 13.34891342006480, 
13.45514937494240, 13.561385329820000, 13.658768288457800, 13.773857239575200, 13.880093194452800, 
13.986329149330400, 14.092565104208100, 14.170471471118300, 14.269625029004100, 
14.305037013963300, 14.411272968840900, 14.517508923718500, 14.62374487859610, 14.694568848514500, 
14.774245814672700, 14.84802078333770, 14.907040758269700, 15.013276713147300, 15.11951266802500, 
15.225748622902600, 15.331984577780200, 15.438220532657800, 15.5267504950558, 15.544456487535400, 
15.650692442413000, 15.739222404811000, 15.756928397290600, 15.801193378489600, 
15.874968347154600, 15.933988322086600, 15.969400307045800, 16.075636261923500, 
16.181872216801100, 16.28810817167870, 16.252696186719500, 16.366014538588900, 16.341226149117500, 
16.441560106501900, 16.5005800814339, 16.59796304007170, 16.642228021270700, 16.713051991189100, 
16.819287946066700, 16.92552390094430, 17.031759855822000, 17.137995810699600, 17.208819780618000, 
17.27964375053640, 17.350467720454800, 17.38587970541400, 17.456703675332400, 17.515723650264400, 
17.527527645250800, 17.58654762018280, 17.562939630210000, 17.66917558508760, 17.651469592608000, 
17.739999555006000, 17.704587570046800, 17.810823524924400, 17.846235509883600, 17.88164749484280, 
17.917059479802000, 17.98788344972040, 17.98788344972040, 18.09411940459810, 18.16494337451650, 
18.147237382036900, 18.147237382036900, 18.235767344434900, 18.306591314353300, 18.37741528427170, 
18.412827269230900, 18.37741528427170, 18.490733636141100, 18.536769216588100, 18.58988719402690, 
18.66071116394530, 18.76694711882290, 18.837771088741300, 18.820065096261700, 18.87318307370050, 
18.908595058659700, 18.908595058659700, 18.890889066180100, 18.890889066180100, 
18.890889066180100, 18.991223023564600, 19.050242998496600, 19.08565498345580, 19.121066968415000, 
19.08565498345580, 19.227302923292600, 19.26271490825180, 19.333538878170200, 19.368950863129400, 
19.4486278292876, 19.538928390933600, 19.616834757843800, 19.58142277288460, 19.723070712721400, 
19.829306667599000, 19.926689626236800, 20.048860974346100, 20.130308539752300, 
20.130308539752300, 20.14801453223190, 20.25425048710950, 20.33687845201430, 20.395898426946300, 
20.4313104119055, 20.466722396864700, 20.484428389344300, 20.51984037430350, 20.53754636678310, 
20.57295835174230, 20.590664344221900, 20.608370336701500, 20.64378232166070, 20.66148831414030, 
20.66148831414030, 20.66148831414030, 20.66148831414030, 20.66148831414030, 20.66148831414030, 
20.655586316647100, 20.702802296592700, 20.714606291579100, 20.73231228405870, 20.75001827653830, 
20.761822271524700, 20.803136253977100, 20.82084224645670, 20.83264624144310, 20.873960223895500, 
20.873960223895500, 20.873960223895500, 20.900519212614900, 20.997902171252800, 
21.104138126130400, 21.210374081008000, 21.31661003588560, 21.4228459907632, 21.52908194564080, 
21.62646490427860, 21.706141870436800, 21.776965840355200, 21.759259847875600, 21.847789810273600, 
21.883201795232800, 21.91861378019210, 21.977633755124100, 21.989437750110500, 22.02484973506970, 
22.09567370498810, 22.166497674906500, 22.23732164482490, 22.30814561474330, 22.4143815696209, 
22.520617524498500, 22.62685347937610, 22.73308943425370, 22.839325389131300, 22.945561344009000, 
23.051797298886600, 23.158033253764200, 23.264269208641800, 23.370505163519400, 23.47674111839700, 
23.58297707327460, 23.689213028152200, 23.79544898302980, 23.87335534994010, 23.948900917853100, 
24.007920892785100, 24.114156847662700, 24.184980817581100, 24.29121677245870, 24.3974527273363, 
24.503688682213900, 24.57451265213230, 24.645336622050700, 24.716160591969100, 24.78698456188750, 
24.822396546846700, 24.88141652177870, 24.87551452428550, 24.96404448668360, 24.946338494204000, 
25.034868456602000, 24.999456471642800, 25.07028044156120, 25.141104411479600, 25.211928381398000, 
25.291605347556200, 25.380135309954200, 25.47751826859200, 25.495224261071600, 25.54834223851040, 
25.542440241017200, 25.583754223469600, 25.601460215949200, 25.636872200908400, 
25.672284185867600, 25.707696170826800, 25.743108155786000, 25.849344110663600])*1000.0

steinY1 = np.array([7.139134411861730, 7.5037493219312000, 7.5037493219312000, 7.5037493219312000, 
7.5037493219312000, 
8.597594052139580, 10.785283512556200, 11.879128242764600, 12.243743152834200, 14.431432613250900, 
16.25450716359820, 19.098503462139900, 31.02141102141100, 22.452960634778800, 18.442196624014900, 
22.452960634778800, 23.911420275056700, 25.005265005265100, 26.099109735473500, 29.01602901602910, 
29.380643926098500, 29.380643926098500, 29.380643926098500, 29.380643926098500, 31.56833338651530, 
36.672942127487500, 38.13140176776550, 40.68370613825180, 42.50678068859900, 42.50678068859900, 
42.50678068859900, 42.50678068859900, 43.60062541880730, 46.88215960943240, 49.43446397991860, 
53.44522799068260, 58.54983673165500, 63.28983056255790, 70.21751385387760, 73.6813554995374, 
77.5098120552667, 82.61442079623900, 86.98979971707250, 90.27133390769760, 88.81287426741980, 
87.35441462714200, 84.07288043651680, 81.88519097610010, 81.88519097610010, 81.88519097610010, 
81.88519097610010, 83.70826552644730, 86.98979971707250, 90.63594881776700, 96.32394141485070, 
104.85593031047600, 109.96053905144800, 110.32515396151800, 110.32515396151800, 
110.32515396151800, 110.32515396151800, 110.32515396151800, 110.32515396151800, 
111.41899869172600, 113.9713030622120, 116.52360743269800, 117.98206707297600, 119.44052671325400, 
121.26360126360100, 121.62821617367100, 124.18052054415700, 126.00359509450400, 
128.92051437506000, 132.202048565685, 136.57742748651800, 140.67934522480000, 146.42203005839400, 
152.25586861950500, 158.1808609081340, 160.64201155110300, 160.64201155110300, 162.1004711913800, 
166.11123520214400, 170.21315294042600, 175.95583777402000, 180.69583160492300, 
186.52967016603400, 192.36350872714500, 201.114266568812, 206.58349021985400, 211.32348405075700, 
215.88117042662500, 220.80347171256300, 221.89731644277100, 222.26193135284100, 
224.63192826829200, 228.82499973409100, 225.45231181594800, 224.08500590318800, 
224.08500590318800, 224.08500590318800, 224.08500590318800, 227.3665400938130, 232.1065339247160, 
232.47114883478500, 228.46038482402100, 229.0073071891250, 233.49207058298000, 242.40690513417800, 
250.61074061074100, 259.0880372698550, 266.7449503813140, 275.49570822298100, 295.1849133667320, 
288.6218449854810, 282.0587766042310, 270.02648457193900, 292.2679940861760, 285.34031079485600, 
277.1364753182930, 270.02648457193900, 267.4741802014530, 265.10418328600200, 257.9941925396470, 
252.88958379867500, 259.36149845240800, 265.8698745971470, 260.18188200006400, 252.88958379867500, 
242.89913526277200, 234.47653084016700, 236.11729793548000, 241.22190667645200, 241.5865215865220, 
241.5865215865220, 241.5865215865220, 241.5865215865220, 243.04498122679900, 247.05574523756300, 
252.1603539785360, 253.61881361881400, 253.9834285288830, 257.9941925396470, 265.21356775902200, 
270.3910994820090, 276.2249380431200, 278.77724241360600, 276.2249380431200, 271.84955912228600, 
264.01033855579300, 256.9003478094390, 253.61881361881400, 247.3292064201150, 245.96190050735500, 
245.96190050735500, 245.96190050735500, 247.420360147633, 249.97266451811900, 247.05574523756300, 
243.22728868183400, 241.5865215865220, 239.39883212610500, 232.83576374485500, 225.99923418105200, 
220.80347171256300, 215.6988629715900, 210.59425423061800, 210.9588691406870, 210.9588691406870, 
216.7015539742810, 210.9588691406870, 231.0856121765210, 223.53808353808400, 227.3665400938130, 
222.62654626291000, 225.45231181594800, 233.56499356499400, 240.8572917663830, 240.12806194624400, 
240.12806194624400, 241.95113649659100, 246.5088228724590, 252.88958379867500, 259.36149845240800, 
266.01572056117500, 272.5787889424250, 278.77724241360600, 289.3510748056200, 282.0587766042310, 
300.65413701777300, 294.09106863652300, 314.05373496282600, 306.1233606688150, 328.27371645553500, 
321.4371868917320, 337.2979354797540, 347.142538051629, 357.89867789867800, 365.920205920206, 
383.05710669347000, 374.48865630683800, 384.8801812438180, 406.757075847985, 398.00631800631800, 
391.44324962506800, 413.86706659433900, 420.43013497559000, 427.5401257219440, 439.57241775423600, 
433.00934937298600, 447.6668687577780, 440.6662624844440, 446.8647159556250, 440.93972366699600, 
441.4866460321010, 457.8943169852260, 449.41702032611100, 468.2858419222060, 503.0154121063210, 
496.81695863514000, 489.8892753438210, 483.3262069625710, 476.76313858132000, 495.72311390493200, 
487.1546635183000, 478.5862131316680, 468.8327642873100, 464.7308465490280, 466.1893061893060, 
461.4493123584030, 470.20007020007000, 465.2777689141330, 468.55930310475800, 474.79421806694500, 
487.9750470659560, 481.1385175021540, 492.3504259867900, 492.441579714307, 487.428124700852, 
487.26404799132100, 485.51389642298700, 478.95082804173700, 472.38775966048700, 471.2939149302790, 
468.74161055979200, 462.9077719986810, 454.8862439771530, 447.2293308656950, 439.57241775423600, 
433.00934937298600, 426.0816660816660, 417.69552315006900, 410.03861003861000, 402.3816969271510, 
393.63093908548500, 385.974025974026, 379.4109575927760, 372.8478892115260, 366.2848208302750, 
359.7217524490250, 353.158684067775, 345.5017709563160, 338.20947275492700, 329.4587149132600, 
321.4371868917320, 315.2387334205520, 306.8525904889540, 301.74798174798200, 295.54952827680100, 
287.16338534520400, 280.9649318740230, 274.4018634927730, 267.8387951115220, 260.728804365168, 
264.8307221034490, 268.20341002159200, 263.8280311007580, 263.4634161906890, 263.8280311007580, 
266.01572056117500, 269.479562206835, 279.8710871438140, 293.544146271419, 285.34031079485600, 
303.9356712083990, 297.73721773721800, 289.16876735058600, 281.32954678409200, 272.5787889424250, 
265.28649074103600, 257.44727017454300, 250.70189433825800, 242.95382749928200, 236.8465277556190, 
237.21114266568800, 239.39883212610500, 241.5865215865220, 243.04498122679900, 245.59728559728600, 
248.14958996777200, 251.43112415839700, 252.52496888860500, 251.43112415839700, 250.3372794281890, 
248.51420487784100, 248.14958996777200, 247.78497505770200, 244.5034408670770, 237.8674495038130, 
231.74191901464600, 226.63731027367400, 220.80347171256300, 215.33424806152100, 
215.33424806152100, 218.6157822521460, 224.90538945084400, 233.10922492740700, 240.7661380388650, 
248.4230511503240, 255.0772732590910, 263.4634161906890, 276.2249380431200, 268.93263984173100, 
289.98915089824200, 282.0587766042310, 304.48259357350300, 297.3726028271480, 313.5068125977220, 
320.70795707159300, 327.4533329078780, 335.65716838444100, 340.0325473052750, 338.93870257506600, 
332.37563419381600, 325.8125658125660, 317.79103779103800, 312.6864290500650, 305.7587457587460, 
298.4664475573570, 291.5387642660370, 282.7880064243700, 276.58955295318900, 271.484944212217])

steinX2 = np.array([0.31730295507785800, 0.4235389099554690, 0.5297748648330790, 0.6360108197106900, 
0.742246774588301, 0.8484827294659120, 0.9547186843435230, 1.0609546392211300, 1.167190594098740, 
1.273426548976350, 1.3796625038539700, 1.4858984587315800, 1.5921344136091900, 1.698370368486800, 
1.8046063233644100, 1.9108422782420200, 2.01707823311963, 2.1233141879972400, 2.229550142874850, 
2.3357860977524600, 2.4420220526300700, 2.548258007507680, 2.6544939623852900, 2.760729917262910, 
2.8669658721405200, 2.9554958345385300, 3.044025796936530, 3.1502617518141400, 3.256497706691760, 
3.362733661569370, 3.4689696164469800, 3.575205571324590, 3.6814415262022000, 3.7876774810798100, 
3.858501450998220, 3.9718198028676700, 4.059169365767040, 4.141797330671850, 4.240950888557620, 
4.347186843435230, 4.460505195304680, 4.559658753190450, 4.6729771050599, 4.77921305993751, 
4.885449014815120, 4.991684969692730, 5.097920924570340, 5.204156879447950, 5.310392834325560, 
5.416628789203180, 5.522864744080790, 5.629100698958400, 5.728254256844170, 5.8061606237544100, 
5.876984593672820, 5.947808563591230, 6.018632533509640, 6.124868488387250, 6.231104443264860, 
6.3373403981424700, 6.443576353020080, 6.478988337979280, 6.585224292856890, 6.691460247734510, 
6.797696202612110, 6.903932157489730, 7.010168112367340, 7.116404067244950, 7.222640022122560, 
7.328875977000170, 7.43511193187778, 7.54134788675539, 7.6475838416330000, 7.753819796510610, 
7.860055751388220, 7.966291706265830, 8.065445264151600, 8.178763616021060, 8.249587585939460, 
8.30860756087147, 8.391235525776280, 8.462059495694690, 8.568295450572300, 8.674531405449910, 
8.763061367847920, 8.851591330245920, 8.948974288883730, 9.064063240001150, 9.170299194878760, 
9.241123164797160, 9.347359119674770, 9.462448070792190, 9.453595074552390, 9.566913426421840, 
9.524419044470790, 9.674919980547410, 9.772302939185220, 9.878538894062830, 9.98477484894044, 
10.09101080381800, 10.18839376245590, 10.303482713573300, 10.400865672211100, 10.515954623328500, 
10.622190578206100, 10.728426533083700, 10.834662487961300, 10.940898442838900, 
11.038281401476700, 11.144517356354400, 11.259606307471800, 11.365842262349400, 
11.401254247308600, 11.436666232267800, 11.507490202186200, 11.542902187145400, 
11.601922162077400, 11.684550126982200, 11.66684413450260, 11.755374096900600, 11.790786081859800, 
11.826198066819000, 11.826198066819000, 11.897022036737400, 11.932434021696600, 11.96784600665580, 
12.038669976574200, 12.074081961533500, 12.144905931451900, 12.215729901370300, 
12.321965856247900, 12.35737784120710, 12.435284208117300, 12.534437766003100, 12.499025781043900, 
12.614114732161300, 12.64067372088070, 12.64067372088070, 12.693791698319500, 12.711497690799100, 
12.74690967575830, 12.75871367074470, 12.805929650690300, 12.817733645676700, 12.923969600554300, 
13.030205555431900, 13.13644151030960, 13.24267746518720, 13.34891342006480, 13.45514937494240, 
13.561385329820000, 13.667621284697600, 13.773857239575200, 13.873010797461000, 
13.986329149330400, 14.092565104208100, 14.163389074126500, 14.269625029004100, 
14.375860983881700, 14.490949934999100, 14.564724903664100, 14.62374487859610, 14.694568848514500, 
14.71227484099410, 14.783098810912500, 14.80080480339210, 14.871628773310500, 14.977864728188100, 
15.084100683065800, 15.190336637943400, 15.29657259282100, 15.402808547698600, 15.509044502576200, 
15.61528045745380, 15.721516412331400, 15.79234038224980, 15.804144377236200, 15.863164352168200, 
15.874968347154600, 15.933988322086600, 16.040224276964300, 16.146460231841900, 
16.252696186719500, 16.217284201760300, 16.323520156637900, 16.367785137836900, 16.41205011903590, 
16.447462103995100, 16.465168096474700, 16.564321654360500, 16.642228021270700, 
16.713051991189100, 16.819287946066700, 16.92552390094430, 17.031759855822000, 17.10258382574040, 
17.20173738362610, 17.27964375053640, 17.350467720454800, 17.421291690373200, 17.456703675332400, 
17.527527645250800, 17.562939630210000, 17.545233637730400, 17.545233637730400, 17.59835161516920, 
17.66917558508760, 17.704587570046800, 17.68688157756720, 17.76360754497880, 17.757705547485600, 
17.757705547485600, 17.79901952993800, 17.846235509883600, 17.88164749484280, 17.95247146476120, 
18.058707419638900, 18.129531389557300, 18.111825397077700, 18.235767344434900, 
18.306591314353300, 18.40574487223910, 18.490733636141100, 18.4659452466697, 18.598740190266700, 
18.696123148904500, 18.802359103782100, 18.76694711882290, 18.837771088741300, 18.87318307370050, 
18.87318307370050, 18.85547708122090, 18.85547708122090, 18.85547708122090, 18.85547708122090, 
18.95581103860540, 19.014831013537400, 19.032537006017000, 19.032537006017000, 19.032537006017000, 
19.032537006017000, 19.050242998496600, 19.15647895337420, 19.27156790449160, 19.24500891577220, 
19.361868466137500, 19.475186818007000, 19.510598802966200, 19.546010787925400, 19.66109973904280, 
19.75848269768060, 19.793894682639800, 19.876522647544600, 19.93554262247660, 20.041778577354300, 
20.07719056231350, 20.14801453223190, 20.25425048710950, 20.360486441987100, 20.4490164043851, 
20.4490164043851, 20.466722396864700, 20.478526391851100, 20.51984037430350, 20.51984037430350, 
20.51984037430350, 20.53754636678310, 20.55525235926270, 20.55525235926270, 20.55525235926270, 
20.55525235926270, 20.57295835174230, 20.590664344221900, 20.584762346728700, 20.631978326674300, 
20.626076329181100, 20.62017433168790, 20.667390311633500, 20.66148831414030, 20.679194306619900, 
20.696900299099500, 20.696900299099500, 20.714606291579100, 20.73231228405870, 20.73231228405870, 
20.75001827653830, 20.761822271524700, 20.797234256483900, 20.83854823893630, 20.83264624144310, 
20.87986222138870, 20.873960223895500, 20.891666216375100, 20.997902171252800, 21.06872614117120, 
21.174962096048800, 21.281198050926400, 21.387434005804000, 21.493669960681600, 
21.599905915559200, 21.670729885477600, 21.74155385539600, 21.776965840355200, 21.854872207265500, 
21.883201795232800, 21.91861378019210, 21.94222177016480, 21.954025765151300, 21.989437750110500, 
22.02484973506970, 22.060261720028900, 22.09567370498810, 22.166497674906500, 22.201909659865700, 
22.272733629784100, 22.378969584661700, 22.485205539539300, 22.59144149441690, 22.697677449294500, 
22.768501419212900, 22.874737374090500, 22.980973328968200, 23.08720928384580, 23.193445238723400, 
23.29968119360100, 23.4059171484786, 23.512153103356200, 23.618389058233800, 23.72462501311140, 
23.830860967989000, 23.937096922866700, 23.97250890782590, 24.043332877744300, 24.114156847662700, 
24.22039280254030, 24.326628757417900, 24.432864712295500, 24.503688682213900, 24.57451265213230, 
24.609924637091500, 24.70907819497730, 24.751572576928300, 24.822396546846700, 24.78698456188750, 
24.857808531805900, 24.822396546846700, 24.928632501724400, 24.999456471642800, 25.07028044156120, 
25.105692426520400, 25.141104411479600, 25.211928381398000, 25.28275235131640, 25.388988306194, 
25.47751826859200, 25.495224261071600, 25.530636246030800, 25.56604823099000, 25.583754223469600, 
25.583754223469600, 25.636872200908400, 25.707696170826800, 25.77852014074520, 25.849344110663600, 
25.937874073061700])*1000.0

steinY2 = np.array([6.774519501792380, 9.691438782347970, 10.785283512556200, 13.702202793112000, 
15.889892253528600, 
18.442196624014900, 20.629886084431600, 22.817575544848300, 25.005265005265100, 
27.557569375751300, 30.474488656306900, 31.56833338651530, 32.66217811672370, 35.94371230734870, 
39.225246497973800, 41.41293595839060, 44.32985523894620, 45.788314879224000, 46.88215960943240, 
46.88215960943240, 46.88215960943240, 48.340619249710200, 49.06984906984920, 49.06984906984920, 
52.35138326047420, 58.91445164172440, 63.28983056255790, 64.38367529276630, 64.38367529276630, 
64.38367529276630, 64.38367529276630, 66.57136475318300, 70.58212876394690, 73.86366295457210, 
79.69750151568340, 86.04180095089190, 93.18825318825330, 100.4805513896420, 107.04361977089300, 
115.79437761256000, 124.5451354542260, 131.10820383547700, 137.30665730665700, 141.6820362274910, 
143.14049586776900, 142.7758809576990, 139.49434676707400, 133.84281566099800, 131.10820383547700, 
130.01435910526800, 130.01435910526800, 131.47281874554600, 137.8900411627690, 145.87510769329000, 
152.4381760745400, 159.27470563834200, 167.20507993235300, 173.03891849346400, 175.59122286395000, 
172.309688673325, 167.93430975249200, 165.01739047193600, 168.29892466256100, 170.4866141229780, 
173.4035334035330, 175.59122286395000, 179.2373719646450, 182.1542912452000, 182.51890615527000, 
184.70659561568700, 188.7173596264510, 192.7281236372150, 197.4681174681170, 198.92657710839500, 
203.3019560292290, 207.31272003999300, 212.0527138708960, 220.25654934745900, 226.81961772870900, 
233.20037865492400, 239.94575449120900, 245.59728559728600, 247.420360147633, 248.87881978791100, 
250.3372794281890, 256.1711179893000, 261.8226490953760, 268.93263984173100, 273.85494112766800, 
282.0587766042310, 287.8926151653420, 300.9275982003260, 292.4503015412110, 308.5298190752740, 
299.56029228756500, 316.5148856057950, 321.4371868917320, 322.53103162194100, 322.53103162194100, 
323.6248763521490, 327.7267940904300, 333.46947892402400, 329.6410223682950, 326.9064105427740, 
328.0002552729830, 329.4587149132600, 331.2817894636080, 332.37563419381600, 335.65716838444100, 
332.102173011264, 330.5525596434690, 329.82332982333000, 338.39178020996200, 348.78330514694200, 
356.0756033483310, 363.0032866396500, 371.0248146611780, 384.05979769616100, 376.6763457672550, 
393.26632417541500, 400.9232372868740, 415.5078336896520, 408.9447653084020, 413.32014422923500, 
405.29861620770700, 399.1001627365260, 392.5370943552760, 382.4190306008490, 375.3090398544940, 
368.8371252007620, 363.0032866396500, 357.16944807853900, 350.97099460735800, 357.8075241711610, 
350.97099460735800, 364.6440537349630, 377.22326813235900, 370.66019975110900, 361.90944190944200, 
355.34637352819200, 346.2310007764550, 338.20947275492700, 330.91717455353800, 323.2602614420800, 
325.0833359924270, 329.09410000319100, 333.83409383409400, 333.83409383409400, 331.6464043736770, 
332.37563419381600, 333.46947892402400, 335.2925534743720, 340.0325473052750, 345.2830020102750, 
349.51253496708000, 349.8771498771500, 358.35444653626500, 361.90944190944200, 365.190976100067, 
368.4725102906920, 363.0032866396500, 357.89867789867800, 344.9548485912120, 353.158684067775, 
345.5017709563160, 338.5740876649970, 331.82871182871200, 326.1771807226350, 324.7187210823570, 
325.8125658125660, 328.7294850931220, 330.91717455353800, 328.0002552729830, 322.1664167118710, 
317.06180797089900, 308.5845113117840, 298.1018326472870, 292.6326089962450, 284.24646606464800, 
280.60031696395300, 280.9649318740230, 280.9649318740230, 287.8014614378250, 280.9649318740230, 
296.27875809694, 304.48259357350300, 312.6864290500650, 303.9356712083990, 296.64337300700900, 
299.3415233415230, 308.8579724943360, 315.2387334205520, 313.4156588702040, 308.6756650393010, 
308.8579724943360, 315.6033483306210, 321.4371868917320, 332.64909537636800, 339.48562494017000, 
346.0486933214210, 355.6198347107440, 363.7325164597890, 384.1509514236790, 376.1294234021510, 
369.5663550209010, 392.17247944520700, 400.46746864928700, 416.60167841986000, 407.8509205781930, 
436.6554984736800, 428.6339704521520, 423.1647468011100, 445.7708712254170, 456.52701107246600, 
467.4654583745490, 476.4896773987680, 483.05274578001900, 496.7258049076230, 488.79543061361200, 
502.2861822861820, 508.48463575736300, 516.7978557069470, 532.7679887679890, 525.4392290755930, 
528.99422444877, 532.9138347320170, 540.2061329334060, 533.6430645521550, 549.6861205952120, 
589.7937607028520, 583.9599221417400, 577.3968537604900, 570.83378537924, 564.2707169979900, 
557.7076486167400, 583.2306923216010, 576.6676239403510, 569.7399406490310, 563.1768722677810, 
556.6138038865310, 550.050735505281, 544.2168969441700, 546.039971494517, 542.9407447589270, 
538.5653658380930, 542.1750534477810, 543.4876671240310, 550.050735505281, 557.7076486167400, 
559.6218768946040, 562.083027537573, 557.3430337066700, 555.5199591563230, 550.050735505281, 
550.7799653254200, 542.3938223938220, 534.1899869172600, 532.1846049118780, 529.267685631322, 
523.7984619802800, 517.23539359903, 510.67232521778000, 501.5569524660430, 496.45234372507100, 
489.8892753438210, 483.3262069625710, 475.3046789410430, 468.0123807396540, 461.4493123584030, 
454.8862439771530, 448.3231755959030, 443.4008743099650, 437.38472829381900, 430.0924300924300, 
422.800131891041, 414.41398895944400, 406.757075847985, 399.46477764659600, 391.44324962506800, 
386.5209483391300, 380.5048023229840, 373.94173394173400, 369.0194326557960, 363.0032866396500, 
356.44021825840000, 349.147920057011, 339.6679323952050, 333.10486401395500, 326.9064105427740, 
319.24949743131600, 311.9571992299270, 303.9356712083990, 297.73721773721800, 301.2010593828780, 
306.8525904889540, 304.30028611846800, 302.8418264781900, 302.8418264781900, 303.2064413882600, 
310.4987395896490, 320.343342161524, 327.63564036291300, 334.56332365423300, 344.1891572800660, 
336.75101311465000, 343.3140814959000, 330.91717455353800, 322.53103162194100, 314.5095036004130, 
307.21720539902400, 300.289522107704, 293.72645372645400, 287.8926151653420, 280.9649318740230, 
274.76647840284200, 270.02648457193900, 268.20341002159200, 273.3080187625640, 279.1418573236750, 
284.9756958847870, 287.528000255273, 287.16338534520400, 285.34031079485600, 285.34031079485600, 
285.34031079485600, 285.34031079485600, 283.51723624450900, 279.8710871438140, 276.2249380431200, 
274.0372485827030, 268.93263984173100, 262.7341863705500, 257.2649627195080, 251.43112415839700, 
247.420360147633, 248.14958996777200, 251.1576629758450, 257.6295776295780, 264.28379973834500, 
273.3080187625640, 280.30862503589800, 291.90337917610600, 304.7560547560550, 297.3726028271480, 
319.52295861386800, 312.6864290500650, 329.09410000319100, 336.02178329451100, 341.8556218556220, 
348.78330514694200, 355.71098843826100, 362.4563642745460, 370.66019975110900, 375.40019358201200, 
370.66019975110900, 363.0032866396500, 356.0756033483310, 349.147920057011, 342.22023676569100, 
335.65716838444100, 327.4533329078780, 319.79641979642000, 313.23335141517000, 305.8498994862630, 
303.38874884329400])

davisX1 = np.array([0.15382511690929400, 0.4387577787505340, 0.6361849340133860, 0.9434702361417030, 
1.2505015309940300, 1.4260205587027900, 1.5577233313033500, 1.777058614120300, 1.9526411436480500, 
2.128350676813800, 2.303742700884560, 2.6546537526640800, 2.786483528902640, 3.665031194731370, 
3.92869074720849, 4.10414627309825, 4.870168715663630, 5.067087856374510, 5.176850750511480, 
5.286677146467440, 5.572530584684140, 5.6825474860971000, 5.94646104585021, 6.143951702932060, 
6.2530478279695600, 6.253428838883540, 6.340172323633960, 6.340616836366940, 6.427466157482360, 
6.514675322238760, 6.558237570070960, 6.776937834697930, 6.9094026291264700, 7.152106581334450, 
7.350274591152270, 7.482167869209830, 7.5919836815292900, 7.899014976381620, 8.183884136403870, 
8.402965411944820, 8.753558954629350, 8.929014480519110, 9.104597010046860, 9.302182919857210, 
9.477828951203960, 9.631408100449120, 9.806165106329900, 10.113323404820200, 10.245026177420800, 
10.420799212405500, 10.64051550613650, 10.947864310083800, 11.321445511245400, 11.6065051767246, 
11.737699934773200, 11.781262182605400, 11.868704187364800, 11.956019188486200, 
12.439395034694200, 12.615295073317000, 12.812341217665800, 12.966036786912500, 
13.667012199551600, 13.886855496920500, 14.106317783375400, 14.281582803808200, 
14.412862230948800, 14.522318199627300, 14.719110336700100, 14.806615843278500, 
14.983023896453200, 15.18162583536750, 15.468304797231200, 16.174064013568100, 16.570823378663700, 
16.79155570149860, 17.033307126421600, 17.143101771468100, 17.515476438068700, 17.602981944647100, 
17.668346483668400, 17.843272827733200, 17.95268646186570, 18.14985960985250, 18.193421857684700, 
18.280800360625100, 18.49835759251010, 18.49886560706210, 18.80430935643950, 18.89153968846890, 
19.02254923287880, 19.219484249044400, 19.35042499981700, 19.63504015256320, 19.766996932439800, 
19.85526446084610, 20.03129150310690, 20.469835065102800, 20.557340571681200, 20.84290825171240, 
20.909140648926600, 21.043129487011100, 21.08758076030930, 21.132286040883400, 21.265004842588000, 
21.309710123162100, 21.310027632257100, 21.35441540373630, 21.399057182491400, 21.862779215719800, 
22.038901510709000, 22.43686741036560, 22.45922005065270, 22.481667943668200, 22.526119216966400, 
22.570538739355100, 22.636834638388300, 22.681222409867500, 22.857376455766200, 
22.989206232004800, 23.208414511183700, 23.778279834866200, 23.866166352358600, 24.12969890119770, 
24.393993471864800, 24.54868390294240, 24.61497980197570, 24.659304071635900, 25.186464422042600, 
25.230058420784300, 25.273493664978500, 25.404815426665100, 25.469968292956400, 
25.448377674497300, 25.535565671980700, 25.579191421631900, 25.622753669464100, 
25.688255795759900, 25.797764682620900, 25.929255782491400, 26.061297231460000, 26.19355035315850, 
26.325972813041100, 26.43652947991550, 26.85468895801320, 26.964737610335700, 27.251067312194900, 
27.470847107744800, 27.690372896018800, 27.778132409873100, 27.95396894667690])*1000.0

davisY1 = np.array([16.313447863445500, 27.7833580834822, 33.01527295067610, 38.276822000069000, 
47.681229720850900, 51.87150308375790, 53.978493438090900, 60.252049809572000, 63.40660850463180, 
64.4897378639971, 
70.75144056259860, 81.20341662410730, 81.2389776427458, 86.65462443957230, 86.7257464768494, 
91.95173450760360, 140.83776317181600, 154.35539538178800, 155.93860156575800, 156.48609308188000, 
152.93814061813200, 150.37848813071200, 146.3067514966000, 150.5029516959470, 162.96116189231300, 
156.74687388522900, 175.41344525223900, 168.16344257730800, 185.10382283123900, 196.175153300702, 
202.401294980665, 219.03199803061900, 208.71041237078500, 192.20417288606600, 185.3527499617090, 
184.35259631250000, 185.0727069399300, 194.47711466071200, 206.98273954859600, 217.39915459146600, 
233.02970399221100, 238.25569202296500, 241.410250718025, 244.0528789156010, 246.17172294281300, 
249.83821213535700, 266.4570615124310, 273.79003989751900, 275.89703025185200, 275.9444449433700, 
276.00371330776700, 280.22954768931300, 279.2945892409410, 288.69307012528300, 299.0857778223950, 
305.3119195023580, 312.5856295230470, 321.9307688794320, 322.0611592811060, 320.0371446369300, 
331.48334751120700, 333.2510264793640, 367.9645075070120, 365.9523465357150, 370.1544735715010, 
378.4876056057970, 387.49936041244500, 394.0885208243430, 409.67758237001, 415.9155777228530, 
405.605845735898, 391.67703924791800, 374.6647961021550, 331.3544388186430, 310.74682851761300, 
294.2346621964550, 293.2641427294450, 294.3294915794910, 313.07311182021700, 319.3111071730600, 
328.3050814703890, 342.1620250665370, 349.4416619236660, 358.8164354622490, 365.0425771422120, 
373.3520018307490, 408.62556890195300, 400.33985155917500, 435.6371259761390, 446.3632182229860, 
459.7767603679850, 473.03546391099500, 487.57103027949500, 504.2195138387680, 502.1836455217120, 
495.99306486038700, 491.89762088051600, 506.51616295917300, 512.7541583120160, 513.8669218535800, 
508.7061290236630, 473.5273913354950, 465.25352766559600, 452.83680532430900, 438.3723609930860, 
425.95563865179800, 420.7770653125620, 413.5389163105110, 402.15790863707000, 364.47878682588100, 
358.8297708442390, 318.54358185411100, 312.3352206834680, 304.573287511053, 296.2994238411550, 
288.54341750518000, 282.34691000741500, 275.10876100536400, 268.94188768979900, 268.9774487084370, 
277.3224344156130, 300.26225485568600, 300.285962201445, 302.42851357441700, 292.1424889332210, 
277.6839714384380, 271.4874639406740, 265.2850296064700, 268.01656035064200, 273.72484469668100, 
282.0224157123390, 290.34369407375500, 302.79005059724200, 296.5698357537180, 307.9864044457970, 
313.17683145791300, 319.40297313787600, 326.15289898820200, 331.87896384356100, 
337.43833642405200, 334.0215152165330, 327.1523117828560, 317.5212025682540, 306.1579754041330, 
294.8777239501680, 291.80021412882500, 280.48440165622200, 279.50795535277300, 282.67436772071200, 
284.7695044021650, 283.7812044258360])



topo = np.array([-753.7313, -793.53235, -848.2587, -878.84297655, -938.02966106,
 -922.88556,    -927.72001157, -868.1592,     -895.82853249, -881.93643961,
 -888.0597,     -888.0597,     -888.0597,     -871.52945486, -852.79556936,
 -856.26066725, -858.63951193, -845.440663,   -838.3085,     -838.3085,
 -838.3085,     -831.26670401, -825.56673277, -838.3085,     -868.64322651,
 -843.56681111, -818.40411627, -795.31078668, -789.69770105, -789.3878811,
 -787.45327965, -844.1099146,  -873.43825483, -902.69798843, -937.56739466,
 -927.8607,     -940.96815464, -947.67606804, -887.59503321, -922.88556]) + 650.0
 
# sides = np.zeros(30)
# topoGrid = np.zeros(len(topo))
# for i in range(1,len(topo)-1):
#     topoGrid[i] = -topo[i]*2.0/(y[1]-y[0])
#     topoGrid[i] = 40 - int(topoGrid[i])/2.0
#     # sides[i] = -1000.0*1.86*(temp[topoGrid[i],i] - temp[topoGrid[i],i-1])*5.0/(x[1]-x[0])
#     # if np.abs((temp[topoGrid[i],i] - temp[topoGrid[i],i+1])) > np.abs(temp[topoGrid[i],i] - temp[topoGrid[i],i-1]):
#     #     sides[i] = -1000.0*1.86*(temp[topoGrid[i],i] - temp[topoGrid[i],i+1])*5.0/(x[1]-x[0])
# print topoGrid
#
# for i in range(1,len(topo)-1):
#     if topoGrid[i] > topoGrid[i-1]:
#         sides[i] = -1000.0*1.86*(temp[topoGrid[i],i] - temp[topoGrid[i-1],i])*(topoGrid[i]-topoGrid[i-1])/(x[1]-x[0])
#     if topoGrid[i] > topoGrid[i+1]:
#         sides[i] = -1000.0*1.86*(temp[topoGrid[i],i] - temp[topoGrid[i+1],i])*(topoGrid[i]-topoGrid[i+1])/(x[1]-x[0])
#
#
# for i in range(1,len(topo)-1):
#     if topoGrid[i] <= topoGrid[i-1] and topoGrid[i] <= topoGrid[i+1]:
#         sides[i] = sides[i+1]
#         if sides[i+1] == 0.0:
#             sides[i] = sides[i-1]
#
# sides = np.zeros(40)
# sides[18:25] = 1000.0*1.14*(temp[-2,16] - temp[-2,18:25])*(np.arange(18,25)-18.0)/((x[1]-x[0]))
# sides[25:32] = 1000.0*1.14*(temp[-2,33] - temp[-2,25:32])*(32.0-np.arange(25,32))/((x[1]-x[0]))

        
# for i in range(1,len(topo)-1):
#     if topoGrid[i] == topoGrid[i-1]:
#         sides[i] = np.min(sides[i-3:i+3])
#     if topoGrid[i] == topoGrid[i+1]:
#         sides[i] = np.max(sides[i-3:i+3])


fig=plt.figure()
ax1=fig.add_subplot(1,1,1)


hfTop = -1000.0*lam[-1,:]*(temp[-1,:] - temp[-2,:])/(y[1]-y[0])
#ax1.plot(x,hfTop[::-1],'m-',linewidth=1.0, label='model')
hfTop1 = -1000.0*1.2*(temp[-1,:] - temp[-2,:])/(y[1]-y[0])
hfTop2 = -1000.0*(lam[-1,:]/1.2)*(temp[-1,:] - temp[-2,:])/(y[1]-y[0])




ax1.plot(steinX1[::2],steinY1[::2], 'r-', label='Stein 2004 7.9 m/yr')
ax1.plot(steinX2[::2],steinY2[::2], 'b-', label='Stein 2004 4.9 m/yr')
#ax1.plot(davisX1[::2],davisY1[::2], 'c-', label='Stein 2004 4.9 m/yr')

ax1.plot(x,hfTop,'g-',linewidth=2.0, label='model')
ax1.plot(x,hfTop1,'k-',linewidth=2.0, label='model')
ax1.plot(x,hfTop2,'m-',linewidth=2.0, label='model')

# plot data points
plt.scatter(ripXdata,ripQdata,10,color='k',label='ODP observations (Alt et al. 1996)',zorder=4)

plt.xlabel('LATERAL DISTANCE [m]')
plt.ylabel('HEAT FLOW [mW m$^{-2}$]')
plt.title('HEAT FLOW OUT OF RIFT FLANK')
plt.xlim([0,26000])
plt.ylim([0,700])


#plt.legend()


plt.savefig(path+'jdfFlux.eps')



